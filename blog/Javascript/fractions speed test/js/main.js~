
function getApproximateFraction(d) {
	var a,
	b,
	pN = 1,
	pD = 0,
	gN = 0,
	gD = 1,
	d2 = d,
	L2,
	val,
	oldVal = NaN,
	lim = 1e3;
	
	while (lim--) {
		L2 = Math.floor(d2);
		a = L2 * pN + gN;
		b = L2 * pD + gD;
		val = a / b;
		if (val == d || val == oldVal) {
			break;
		}
		oldVal = val;
		
		d2 = 1 / (d2 - L2);
		gN = pN;
		gD = pD;
		pN = a;
		pD = b;
	}
	return [a, b];
}
var checkRatioSimplify = function (min, max, fn) {
	var badValues = 0,
	x = [],
	expect,
	output;
	
	if (max <= min) {
		throw new Error("Min is too high");
	}
	for (var i = min, len = max; i < len; i++) {
		expect = "1/" + i;
		x = fn(1 / i);
		output = x ? x[0] + "/" + x[1] : "null";
		
		if (expect !== output) {
			badValues++;
		}
	}
	return badValues;
};
var runTest = function(name, min, max, fn){
		console.time(name);
		var x = checkRatioSimplify(min, max, fn);
		console.timeEnd(name);
		var amountTested = (max - min);
		var errRate = (100 * ( x / amountTested )).toFixed(2);
		console.log("%s: Error rate = %s%, [%s, %s] has %s different fractions.", name, errRate, min, max, x);
	};

var MIN = 1, 
	MAX = 1e4;
runTest("getApproximateFraction()", MIN, MAX, function(d){
	return getApproximateFraction(d);
});
runTest("Ratio()", MIN, MAX, function(d){
	return Ratio.parse(d).simplify().toArray();
});
runTest("rat()", MIN, MAX, function(d){
	return rat.fromDecimal(d);
});
console.log("done");















